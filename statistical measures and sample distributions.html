<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í†µê³„ëŸ‰ê³¼ í‘œë³¸ë¶„í¬ ì‹œë®¬ë ˆì´ì…˜</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f7f6;
        }
        h1, h2 { color: #2c3e50; }
        .container {
            background-color: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .concept-box {
            background-color: #e8f4fd;
            border-left: 5px solid #3498db;
            padding: 15px;
            margin-bottom: 20px;
        }
        .highlight { color: #e74c3c; font-weight: bold; }
        
        /* ì‹œë®¬ë ˆì´ì…˜ ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .sim-area { display: flex; flex-wrap: wrap; gap: 20px; justify-content: space-between; }
        .sim-box {
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            padding: 15px;
            flex: 1 1 40%;
            min-width: 300px;
            background: #fafafa;
        }
        .sim-box h3 { margin-top: 0; text-align: center; color: #7f8c8d; }
        
        #population-viz, #sample-viz {
            height: 150px;
            overflow-y: auto;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            align-content: flex-start;
            padding: 10px;
            background: #fff;
            border: 1px solid #eee;
        }
        .data-point {
            width: 25px; height: 25px;
            background-color: #bdc3c7; color: white;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; transition: all 0.3s;
        }
        .data-point.sampled { background-color: #e74c3c; transform: scale(1.2); z-index: 10;}
        .data-point.in-sample-box { background-color: #3498db; }

        .controls { text-align: center; margin: 20px 0; }
        button {
            padding: 12px 24px; margin: 5px;
            font-size: 16px; cursor: pointer;
            background-color: #3498db; color: white;
            border: none; border-radius: 5px;
            transition: background-color 0.2s;
        }
        button:hover { background-color: #2980b9; }
        button.secondary { background-color: #95a5a6; }
        button.secondary:hover { background-color: #7f8c8d; }
        
        #current-stats {
            text-align: center; font-size: 1.2em; margin: 15px 0;
            padding: 15px; background: #ecf0f1; border-radius: 8px;
        }
        .stat-value { font-weight: bold; color: #3498db; font-size: 1.4em;}

        /* ì°¨íŠ¸ ì˜ì—­ */
        #chart-container { height: 350px; position: relative; }
    </style>
</head>
<body>

    <h1>í†µê³„ëŸ‰ê³¼ í‘œë³¸ë¶„í¬ì˜ ì´í•´</h1>

    <div class="container">
        <div class="concept-box">
            <strong>í•µì‹¬ ê°œë…:</strong> í‘œë³¸í‰ê· , í‘œë³¸ë¶„ì‚° ë“±ì€ <strong>í†µê³„ëŸ‰</strong>ì…ë‹ˆë‹¤. 
            ê°™ì€ ëª¨ì§‘ë‹¨ì—ì„œ í‘œë³¸ì„ ë½‘ë”ë¼ë„, ì–´ë–¤ í‘œë³¸ì´ ë½‘íˆëŠëƒì— ë”°ë¼ ì´ ê°’ì€ ë§¤ë²ˆ ë‹¬ë¼ì§‘ë‹ˆë‹¤. 
            ë”°ë¼ì„œ <strong>í‘œë³¸í‰ê· ì€ ê·¸ ìì²´ê°€ ê³ ìœ ì˜ í™•ë¥ ë¶„í¬ë¥¼ ê°€ì§€ëŠ” 'í™•ë¥ ë³€ìˆ˜'</strong>ì…ë‹ˆë‹¤.
        </div>
        <p>ì•„ë˜ ì‹œë®¬ë ˆì´ì…˜ì„ í†µí•´ ì´ ê°œë…ì„ ì§ì ‘ ëˆˆìœ¼ë¡œ í™•ì¸í•´ë³´ì„¸ìš”.</p>
    </div>

    <div class="container">
        <h2>1ë‹¨ê³„: ëª¨ì§‘ë‹¨ê³¼ í‘œë³¸ ì¶”ì¶œ</h2>
        <p>ì„¤ì •: 0ë¶€í„° 100ê¹Œì§€ì˜ ìˆ«ìê°€ ê· ë“±í•˜ê²Œ ì„ì¸ <strong>ëª¨ì§‘ë‹¨(N=500)</strong>ì—ì„œ <strong>í¬ê¸°ê°€ 10ì¸ í‘œë³¸</strong>ì„ ë¬´ì‘ìœ„ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤.</p>
        
        <div class="sim-area">
            <div class="sim-box">
                <h3>ëª¨ì§‘ë‹¨ (Population)</h3>
                <div id="population-viz"></div>
                <p>ëª¨ìˆ˜ (ì‹¤ì œ í‰ê· ) Î¼ = <span id="pop-mean">50.0</span></p>
            </div>
            <div class="sim-box" style="border-color: #3498db;">
                <h3>í˜„ì¬ ì¶”ì¶œëœ í‘œë³¸ (Current Sample, n=10)</h3>
                <div id="sample-viz"></div>
            </div>
        </div>

        <div id="current-stats">
            í˜„ì¬ í‘œë³¸ì˜ í‰ê·  (í†µê³„ëŸ‰ xÌ„): <span id="sample-mean-val" class="stat-value">-</span>
            <br>
            <small>(ë²„íŠ¼ì„ ëˆ„ë¥¼ ë•Œë§ˆë‹¤ ì´ ê°’ì´ ë³€í•˜ëŠ” ê²ƒì— ì£¼ëª©í•˜ì„¸ìš”!)</small>
        </div>

        <div class="controls">
            <button id="btn-sample-one">ğŸ‘‰ í‘œë³¸ 1ê°œ ì¶”ì¶œí•˜ê¸°</button>
            <p>ìœ„ ë²„íŠ¼ì„ ì—¬ëŸ¬ ë²ˆ í´ë¦­í•˜ë©° í‘œë³¸í‰ê·  ê°’ì´ ê³„ì† ë³€í•˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì„¸ìš”.</p>
        </div>
    </div>

    <div class="container">
        <h2>2ë‹¨ê³„: í‘œë³¸í‰ê· ì˜ ë¶„í¬ (í‘œë³¸ë¶„í¬)</h2>
        <p>
            ìœ„ì—ì„œ ê³„ì‚°í•œ <strong>"í‘œë³¸í‰ê· (xÌ„)"ë“¤ì„ ê³„ì† ëª¨ì•„ì„œ íˆìŠ¤í† ê·¸ë¨</strong>ì„ ê·¸ë¦½ë‹ˆë‹¤.
            <br>ì²˜ìŒì—ëŠ” ë¶ˆê·œì¹™í•´ ë³´ì´ì§€ë§Œ, ë°ì´í„°ê°€ ìŒ“ì¼ìˆ˜ë¡ ì¢… ëª¨ì–‘ì˜ ì•„ë¦„ë‹¤ìš´ ë¶„í¬(ì •ê·œë¶„í¬ í˜•íƒœ)ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.
            <br>ì´ê²ƒì´ ë°”ë¡œ <span class="highlight">"í‘œë³¸í‰ê· ì€ í™•ë¥ ë¶„í¬ë¥¼ ê°–ëŠ” í™•ë¥ ë³€ìˆ˜ë‹¤"</span>ë¼ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
        </p>
        
        <div class="controls">
            <button id="btn-sample-many" class="secondary">ğŸš€ í‘œë³¸ 100ê°œ ë¹ ë¥´ê²Œ ì¶”ì¶œ ë° ê¸°ë¡</button>
            <button id="btn-reset" style="background-color: #e74c3c;">ì´ˆê¸°í™”</button>
            <p>í˜„ì¬ê¹Œì§€ ìˆ˜ì§‘ëœ í‘œë³¸í‰ê· ì˜ ê°œìˆ˜: <span id="samples-count">0</span>ê°œ</p>
        </div>

        <div id="chart-container">
             <canvas id="samplingDistributionChart"></canvas>
        </div>
    </div>

    <script>
        // --- ì„¤ì • ë³€ìˆ˜ ---
        const POPULATION_SIZE = 500;
        const SAMPLE_SIZE = 10;
        const MAX_VALUE = 100; // ëª¨ì§‘ë‹¨ ë°ì´í„° ë²”ìœ„ (0 ~ 100)

        // --- ìƒíƒœ ë³€ìˆ˜ ---
        let populationData = [];
        let collectedSampleMeans = []; // ì¶”ì¶œëœ í‘œë³¸í‰ê· ë“¤ì„ ì €ì¥í•  ë°°ì—´
        let myChart; // Chart.js ì¸ìŠ¤í„´ìŠ¤

        // --- DOM ìš”ì†Œ ì°¸ì¡° ---
        const popViz = document.getElementById('population-viz');
        const sampleViz = document.getElementById('sample-viz');
        const sampleMeanValDisplay = document.getElementById('sample-mean-val');
        const popMeanDisplay = document.getElementById('pop-mean');
        const samplesCountDisplay = document.getElementById('samples-count');
        const btnSampleOne = document.getElementById('btn-sample-one');
        const btnSampleMany = document.getElementById('btn-sample-many');
        const btnReset = document.getElementById('btn-reset');


        // --- ì´ˆê¸°í™” í•¨ìˆ˜ ---
        function init() {
            // 1. ëª¨ì§‘ë‹¨ ë°ì´í„° ìƒì„± (0~100 ì‚¬ì´ì˜ ê· ë“± ë¶„í¬)
            populationData = [];
            for (let i = 0; i < POPULATION_SIZE; i++) {
                populationData.push(Math.floor(Math.random() * (MAX_VALUE + 1)));
            }

            // 2. ëª¨ì§‘ë‹¨ ì‹œê°í™” ê·¸ë¦¬ê¸°
            popViz.innerHTML = '';
            populationData.forEach((val, idx) => {
                const el = document.createElement('div');
                el.classList.add('data-point');
                el.id = `pop-item-${idx}`;
                el.textContent = val;
                popViz.appendChild(el);
            });

            // 3. ëª¨í‰ê·  ê³„ì‚° ë° í‘œì‹œ
            const popMean = populationData.reduce((a, b) => a + b, 0) / POPULATION_SIZE;
            popMeanDisplay.textContent = popMean.toFixed(2);

            // 4. ì°¨íŠ¸ ì´ˆê¸°í™”
            initChart();
        }

        // --- í•µì‹¬ ê¸°ëŠ¥: í‘œë³¸ ì¶”ì¶œ ë° í†µê³„ëŸ‰ ê³„ì‚° ---
        function takeSampleAnimation() {
            // ì´ì „ ê°•ì¡° í‘œì‹œ ì œê±°
            document.querySelectorAll('.data-point.sampled').forEach(el => el.classList.remove('sampled'));
            sampleViz.innerHTML = '';

            let currentSampleData = [];
            let indices = [];

            // ì¤‘ë³µ ì—†ì´ ëœë¤ ì¸ë±ìŠ¤ ì„ íƒ
            while(indices.length < SAMPLE_SIZE){
                let r = Math.floor(Math.random() * POPULATION_SIZE);
                if(indices.indexOf(r) === -1) indices.push(r);
            }

            // ì„ íƒëœ ë°ì´í„° ì²˜ë¦¬
            indices.forEach(idx => {
                const val = populationData[idx];
                currentSampleData.push(val);

                // ëª¨ì§‘ë‹¨ ì‹œê°í™”ì—ì„œ ê°•ì¡°
                const popEl = document.getElementById(`pop-item-${idx}`);
                if(popEl) popEl.classList.add('sampled');

                // í‘œë³¸ ì‹œê°í™” ì˜ì—­ì— ì¶”ê°€
                const sampleEl = document.createElement('div');
                sampleEl.classList.add('data-point', 'in-sample-box');
                sampleEl.textContent = val;
                sampleViz.appendChild(sampleEl);
            });

            // í†µê³„ëŸ‰(í‘œë³¸í‰ê· ) ê³„ì‚°
            const sampleMean = currentSampleData.reduce((a, b) => a + b, 0) / SAMPLE_SIZE;

            // ê²°ê³¼ ì—…ë°ì´íŠ¸
            updateResults(sampleMean);
        }

        // --- ê²°ê³¼ ì—…ë°ì´íŠ¸ ë° ì°¨íŠ¸ ë°˜ì˜ ---
        function updateResults(mean) {
            // 1. í˜„ì¬ í‘œë³¸í‰ê·  ê°’ í‘œì‹œ ì—…ë°ì´íŠ¸
            sampleMeanValDisplay.textContent = mean.toFixed(2);
            
            // 2. ë°ì´í„° ìˆ˜ì§‘ ë° ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
            collectedSampleMeans.push(mean);
            samplesCountDisplay.textContent = collectedSampleMeans.length;

            // 3. ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateChart();
        }


        // --- ë‹¤ì¤‘ ì‹¤í–‰ (ë¹ ë¥´ê²Œ 100ë²ˆ) ---
        function takeManySamples() {
            let count = 0;
            btnSampleMany.disabled = true;
            btnSampleMany.textContent = "ì‹¤í–‰ ì¤‘...";

            const interval = setInterval(() => {
                takeSampleAnimation();
                count++;
                if(count >= 100) {
                    clearInterval(interval);
                    btnSampleMany.disabled = false;
                    btnSampleMany.textContent = "ğŸš€ í‘œë³¸ 100ê°œ ë¹ ë¥´ê²Œ ì¶”ì¶œ ë° ê¸°ë¡";
                }
            }, 30); // 0.03ì´ˆë§ˆë‹¤ ì‹¤í–‰
        }

        // --- ì°¨íŠ¸ ê´€ë ¨ í•¨ìˆ˜ (Chart.js ì‚¬ìš©) ---
        function initChart() {
            const ctx = document.getElementById('samplingDistributionChart').getContext('2d');
            
            // ì´ˆê¸° ë¹ˆ ë°ì´í„°ìš© bin ìƒì„±
            const bins = createHistogramBins([], MAX_VALUE);

            myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: bins.labels,
                    datasets: [{
                        label: 'í‘œë³¸í‰ê· ë“¤ì˜ ë¹ˆë„ (Frequency)',
                        data: bins.data,
                        backgroundColor: 'rgba(52, 152, 219, 0.6)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1,
                        barPercentage: 1.0,
                        categoryPercentage: 1.0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'ë¹ˆë„ìˆ˜(Frequency)' } },
                        x: { title: { display: true, text: 'í‘œë³¸í‰ê· (xÌ„) ê°’ì˜ êµ¬ê°„' } }
                    },
                    plugins: {
                        legend: { display: false },
                        title: { display: true, text: 'í‘œë³¸í‰ê· ì˜ í‘œë³¸ë¶„í¬ (Sampling Distribution)' }
                    }
                }
            });
        }

        function updateChart() {
            // ìˆ˜ì§‘ëœ ë°ì´í„°ë¡œ íˆìŠ¤í† ê·¸ë¨ bin ë‹¤ì‹œ ê³„ì‚°
            const bins = createHistogramBins(collectedSampleMeans, MAX_VALUE);
            
            myChart.data.labels = bins.labels;
            myChart.data.datasets[0].data = bins.data;
            myChart.update('none'); // ì• ë‹ˆë©”ì´ì…˜ ì—†ì´ ë¶€ë“œëŸ½ê²Œ ì—…ë°ì´íŠ¸
        }

        // íˆìŠ¤í† ê·¸ë¨ ë°ì´í„°ë¥¼ ìœ„í•œ ë„ìˆ˜ë¶„í¬í‘œ ìƒì„± ë„ìš°ë¯¸ í•¨ìˆ˜
        function createHistogramBins(dataArray, maxVal) {
            const binSize = 2; // ê³„ê¸‰ êµ¬ê°„ í¬ê¸°
            const numBins = Math.ceil(maxVal / binSize);
            const bins = new Array(numBins).fill(0);
            const labels = [];

            for (let i = 0; i < numBins; i++) {
                const start = i * binSize;
                const end = (i + 1) * binSize -1;
                labels.push(`${start}~${end}`);
            }

            if(dataArray.length === 0) return { labels, data: bins };

            dataArray.forEach(val => {
                let binIndex = Math.floor(val / binSize);
                // ë²”ìœ„ ë°– ë°ì´í„° ì²˜ë¦¬ (ì•ˆì „ì¥ì¹˜)
                if(binIndex >= numBins) binIndex = numBins - 1; 
                if(binIndex < 0) binIndex = 0;
                bins[binIndex]++;
            });

            return { labels, data: bins };
        }

        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° ---
        btnSampleOne.addEventListener('click', takeSampleAnimation);
        btnSampleMany.addEventListener('click', takeManySamples);
        btnReset.addEventListener('click', () => {
            collectedSampleMeans = [];
            samplesCountDisplay.textContent = 0;
            sampleMeanValDisplay.textContent = "-";
            sampleViz.innerHTML = '';
            document.querySelectorAll('.data-point.sampled').forEach(el => el.classList.remove('sampled'));
            updateChart();
        });

        // --- ì‹¤í–‰ ì‹œì‘ ---
        init();

    </script>
</body>
</html>